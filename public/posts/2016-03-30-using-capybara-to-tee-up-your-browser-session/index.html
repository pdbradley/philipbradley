<!DOCTYPE html>
<html lang="en">




<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    
    Using Capybara to Tee Up an Interactive Browser Session Quickly
     | Philip Bradley 
  </title>
  <link rel="stylesheet" href='http://www.philipbradley.net/css/site.min.eb4797a608f467160f71b5cc518dffb9b3fef0edc95e6def8dc4033ba1888b8f414e3d1d3e6c9804ca3e6f125539d8af48b28dcecb4eafc5805bde0b3c8d6956.css' integrity='sha512-60eXpgj0ZxYPcbXMUY3/ubP&#43;8O3JXm3vjcQDO6GIi49BTj0dPmyYBMo&#43;bxJVOdivSLKNzstOr8WAW94LPI1pVg=='>
  <link rel="canonical" href="http://www.philipbradley.net/posts/2016-03-30-using-capybara-to-tee-up-your-browser-session/">
  <link rel="alternate" type="application/rss&#43;xml" href="http://www.philipbradley.net/index.xml" title="Philip Bradley">
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="author" content="Philip Bradley">
<meta name="description" content="Even though the stuff I make generally is test driven, there always comes a time when you need to click around your web app like a real person would.
In development, I often use a rake task to populate the database with sample data to get a sense of how things will look and feel with &ldquo;real&rdquo; data. But I really loathe needing to log in and navigate to various pages that I&#39;m inspecting.">

<meta property="og:title" content="Using Capybara to Tee Up an Interactive Browser Session Quickly" />
<meta property="og:description" content="Even though the stuff I make generally is test driven, there always comes a time when you need to click around your web app like a real person would.
In development, I often use a rake task to populate the database with sample data to get a sense of how things will look and feel with &ldquo;real&rdquo; data. But I really loathe needing to log in and navigate to various pages that I&#39;m inspecting." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.philipbradley.net/posts/2016-03-30-using-capybara-to-tee-up-your-browser-session/" />
<meta property="article:published_time" content="2016-03-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-01-01T19:14:28-05:00" />


</head>
<body><nav class="navbar is-transparent " role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="http://www.philipbradley.net/">
      <figure class="image">
        <img alt="" class="is-rounded" src="https://www.gravatar.com/avatar/17335e97ee934bff90fe4ddcaf0bb5fd?s=128&d=identicon">
      </figure>
    </a>
    <a class="navbar-item" href="http://www.philipbradley.net/">
      Philip Bradley
    </a>
  </div>
  
  <div class="navbar-menu">
    <div class="navbar-start">
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/ack/">
        
        Ack
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/activerecord/">
        
        Activerecord
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/bootcamps/">
        
        Bootcamps
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/capybara/">
        
        Capybara
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/flashcards/">
        
        Flashcards
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/git/">
        
        Git
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/rails/">
        
        Rails
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/refactoring/">
        
        Refactoring
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/ripgrep/">
        
        Ripgrep
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/rspec/">
        
        Rspec
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/ruby/">
        
        Ruby
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/search/">
        
        Search
        
      </a>
      
      <a class="navbar-item" href="http://www.philipbradley.net/tags/vim/">
        
        Vim
        
      </a>
      
    </div>
    
    <div class="navbar-end">
      
      <a class="navbar-item" href="https://github.com/orf/" rel="noopener" target="_blank">
        <span class="icon">
          <img alt="github-circle" src='http://www.philipbradley.net/icons/svg/github-circle.svg'>
        </span>
      </a>
      
      <a class="navbar-item" href="mailto:nope@example.com" target="_blank">
        <span class="icon">
          <img alt="email" src='http://www.philipbradley.net/icons/svg/email.svg'>
        </span>
      </a>
      <a class="navbar-item" href="http://www.philipbradley.net/index.xml" target="_blank">
        <span class="icon">
          <img alt="rss" src='http://www.philipbradley.net/icons/svg/rss.svg'>
        </span>
      </a>
      
    </div>
  </div>
</nav>
<section class="hero is-small is-info is-fullwidth">
  <div class="hero-body">
<div class="container">
  <h1 class="title">
    Using Capybara to Tee Up an Interactive Browser Session Quickly
  </h1>
  <h2 class="subtitle">
    <time datetime='2016-03-30T00:00:00Z'>
      March 30, 2016
    </time>
    
    <br>
    
    
    
    <a class="tag is-link" href="http://www.philipbradley.net/tags/ruby/">ruby</a>
    
    
    
    
    <a class="tag is-link" href="http://www.philipbradley.net/tags/capybara/">capybara</a>
    
    
    
    
    <a class="tag is-link" href="http://www.philipbradley.net/tags/rails/">rails</a>
    
    
    
    
    <a class="tag is-link" href="http://www.philipbradley.net/tags/rspec/">rspec</a>
    
    
    
  </h2>
</div>

  </div>
</section>
<section class="section">
  <div class="container">
<div class="content is-medium">
  <p>Even though the stuff I make generally is test driven, there always comes a time when you need to click around your web app like a real person would.</p>
<p>In development, I often use a rake task to populate the database with sample data to get a sense of how things will look and feel with &ldquo;real&rdquo; data.  But I really loathe needing to log in and navigate to various pages that I'm inspecting.  Especially when I need to do it again and again.</p>
<p><a href="http://threevirtues.com">They say the best programmers are the lazy ones</a>, and if that's true I have a bright future, because using <a href="https://github.com/jnicklas/capybara">Capybara</a> I find a pretty easy way to automate getting to the place I want to be in my web app.</p>
<p>It isn't hard to get Capybara to navigate through a web path; the hard part is keeping Capybara from killing the browser when it finishes.  But really all you have to do is override the &ldquo;quit&rdquo; method on the driver class, like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby">session <span style="color:#f92672">=</span> <span style="color:#66d9ef">Capybara</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Session</span><span style="color:#f92672">.</span>new(<span style="color:#e6db74">:selenium</span>)
session<span style="color:#f92672">.</span>driver<span style="color:#f92672">.</span>class<span style="color:#f92672">.</span>class_eval { <span style="color:#66d9ef">def</span> <span style="color:#a6e22e"></span><span style="color:#f92672"></span><span style="color:#a6e22e">quit</span>; <span style="color:#66d9ef">end</span> }</code></pre></div>
<p>I got this little tip from a <a href="http://stackoverflow.com/questions/7555416/how-to-leave-browser-opened-even-after-selenium-ruby-script-finishes">strangely undervoted answer</a> by Eliot Larson on Stackoverflow.</p>
<p>Now if you run a script that uses Capybara, it will fire up a browser, do what you tell it, and then exit, but the browser window stays open for you to take over.</p>
<p>I use the script below to log into one application as either a manager, a tutor, or a client, and I make some assumptions about the data in the app (usernames and passwords) but I've also used this approach to actually create a new account each time.</p>
<p>Here is the whole file, which I store in script/login, and use by typing % script/login tutor or % script/login manager etc.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e">#!/usr/bin/env ruby</span>
require <span style="color:#e6db74">&#39;capybara&#39;</span>

role <span style="color:#f92672">=</span> <span style="color:#66d9ef">ARGV</span><span style="color:#f92672">[</span><span style="color:#ae81ff">0</span><span style="color:#f92672"></span><span style="color:#f92672">]</span>
exit <span style="color:#66d9ef">unless</span> <span style="color:#e6db74">%w(</span><span style="color:#e6db74">client manager tutor</span><span style="color:#e6db74">)</span><span style="color:#f92672">.</span>include? role

session <span style="color:#f92672">=</span> <span style="color:#66d9ef">Capybara</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Session</span><span style="color:#f92672">.</span>new(<span style="color:#e6db74">:selenium</span>)
session<span style="color:#f92672">.</span>driver<span style="color:#f92672">.</span>class<span style="color:#f92672">.</span>class_eval { <span style="color:#66d9ef">def</span> <span style="color:#a6e22e"></span><span style="color:#f92672"></span><span style="color:#a6e22e">quit</span>; <span style="color:#66d9ef">end</span> }
session<span style="color:#f92672">.</span>visit(<span style="color:#e6db74">&#39;http://127.0.0.1:3000&#39;</span>)

<span style="color:#66d9ef">case</span> role
<span style="color:#66d9ef">when</span> <span style="color:#e6db74">&#39;tutor&#39;</span>
  session<span style="color:#f92672">.</span>click_link <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Sign in as a Tutor</span><span style="color:#e6db74">&#34;</span>
  session<span style="color:#f92672">.</span>fill_in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Email</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">with</span>: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">tutor1@example.com</span><span style="color:#e6db74">&#34;</span>
  session<span style="color:#f92672">.</span>fill_in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Password</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">with</span>: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">123123</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">when</span> <span style="color:#e6db74">&#39;manager&#39;</span>
  session<span style="color:#f92672">.</span>click_link <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Sign in as a Manager</span><span style="color:#e6db74">&#34;</span>
  session<span style="color:#f92672">.</span>fill_in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Email</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">with</span>: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">manager1@example.com</span><span style="color:#e6db74">&#34;</span>
  session<span style="color:#f92672">.</span>fill_in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Password</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">with</span>: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">123123</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">when</span> <span style="color:#e6db74">&#39;client&#39;</span>
  session<span style="color:#f92672">.</span>click_link <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Sign in as a Client</span><span style="color:#e6db74">&#34;</span>
  session<span style="color:#f92672">.</span>fill_in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Email</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">with</span>: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">client1@example.com</span><span style="color:#e6db74">&#34;</span>
  session<span style="color:#f92672">.</span>fill_in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Password</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">with</span>: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">123123</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">end</span>

session<span style="color:#f92672">.</span>click_button <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Log in</span><span style="color:#e6db74">&#34;</span></code></pre></div>

</div>


  </div>
</section><footer class="footer">
  <div class="content has-text-centered">
    
    <p>
      Last modified January 01, 2020
      
      (commit 680bbe0)
      
    </p>
    
    
    <p>
      
      
    </p>
    
  </div>
</footer>


</body>
</html>
